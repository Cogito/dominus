<template name="rp_info_castle">
	<div class="rp_content" id="rp_info_castle">
		{{#if castleInfoLoaded}}
			<div class="panel panel-default" style="margin-top:0;">
				{{#if is_owner}}

					<div class="panel-heading">
						<h4>
							<span class="light_text">Castle</span> {{name}}
							&nbsp;
							{{> edit_name_button}}
						</h4>
						{{> hex_location}} &nbsp;&nbsp; {{> center_on_button x=x y=y selected_type='castle' selected_id=_id}}
					</div>

				{{else}}

					<div class="panel-heading">
						<h4>
							<div style="margin-bottom:8px;">
								<span class="light_text">Castle</span> {{name}}
							</div>
							<span class="light_text">Lord</span> {{username}}
						</h4>
					</div>
					{{#if castleUserLoaded}}
						<table class="table table-condensed table-striped">
							<tbody>
								<tr>
									<td>Vassals</td>
									<td style="text-align:right;">{{round user.num_allies_below}}</td>
								</tr>
								<tr>
									<td>Networth</td>
									<td style="text-align:right;">{{round user.networth}}</td>
								</tr>
								<tr>
									<td>Income</td>
									<td style="text-align:right;">{{round user.income}}</td>
								</tr>
								<tr>
									<td>Lost Soldiers</td>
									<td style="text-align:right;">{{round user.losses_worth}}</td>
								</tr>
							</tbody>
						</table>
					{{/if}}
					<div class="panel-body" style="text-align:center;">
						{{> hex_location}} &nbsp;&nbsp; {{> center_on_button x=x y=y selected_type='castle' selected_id=_id}}
					</div>

				{{/if}}
			</div>


			{{#if is_lord}}
				<div class="panel panel-default">
					<div class="panel-body">
						Lord {{username}} is your lord.
					</div>
				</div>
			{{/if}}

			{{#if is_vassal}}
				<div class="panel panel-default">
					<div class="panel-body">
						Lord {{username}} is a vassal of yours.
					</div>
				</div>
			{{/if}}


			<div class="panel panel-default">
				<div class="panel-heading">
					Castle Garrison
				</div>
				<table class="table table-condensed table-striped">
					<tbody>
						<tr>
							<td>Footmen</td>
							<td style="text-align:right;">{{round footmen}}</td>
						</tr>
						<tr>
							<td>Archers</td>
							<td style="text-align:right;">{{round archers}}</td>
						</tr>
						<tr>
							<td>Pikemen</td>
							<td style="text-align:right;">{{round pikemen}}</td>
						</tr>
						<tr>
							<td>Cavalry</td>
							<td style="text-align:right;">{{round cavalry}}</td>
						</tr>
						<tr>
							<td>Catapults</td>
							<td style="text-align:right;">{{round catapults}}</td>
						</tr>
					</tbody>
				</table>
			</div>

			{{#if is_ally_below}}
				<div class="pad_group">
					<button type="button" class="btn btn-sm btn-primary btn-block" id="send_gold_button">Send Gold to {{username}}</button>
					<button type="button" class="btn btn-sm btn-primary btn-block" id="hire_army_from_castle_button">Hire Soldiers for {{username}}</button>
				</div>
			{{/if}}


			{{#if is_owner}}
				<div class="pad_group">
					<button type="button" class="btn btn-sm btn-primary btn-block" id="hire_army_from_castle_button">Hire Soldiers</button>

					<button type="button" class="btn btn-sm btn-primary btn-block" id="send_army_from_castle_button" disabled="{{no_soldiers}}">Send Army from Castle</button>
				</div>

				{{#if resInfoLoaded}}
					<div class="panel panel-default">
						<div class="panel-heading">
							Resource Collection
						</div>
						<table class="table table-condensed table-striped">
							<tbody>
								<tr>
									<td>Gold</td>
									<td style="text-align:right;">{{resources_per_interval.gold}}</td>
								</tr>
								<tr>
									<td>Grain</td>
									<td style="text-align:right;">{{resources_per_interval.grain}}</td>
								</tr>
								<tr>
									<td>Lumber</td>
									<td style="text-align:right;">{{resources_per_interval.lumber}}</td>
								</tr>
								<tr>
									<td>Ore</td>
									<td style="text-align:right;">{{resources_per_interval.ore}}</td>
								</tr>
								<tr>
									<td>Wool</td>
									<td style="text-align:right;">{{resources_per_interval.wool}}</td>
								</tr>
								<tr>
									<td>Clay</td>
									<td style="text-align:right;">{{resources_per_interval.clay}}</td>
								</tr>
								<tr>
									<td>Glass</td>
									<td style="text-align:right;">{{resources_per_interval.glass}}</td>
								</tr>
							</tbody>
						</table>
						<div class="panel-body light_text" style="text-align:center;">
							Collected every {{interval}}<br>
							from surrounding hexes.
						</div>
					</div>
				{{/if}}

				{{#if more_than_one_owned_image}}
					<div class="panel panel-default">
						<div class="panel-heading">
							Set Castle Image
						</div>
						<div class="panel-body">
							{{#each owned_images}}
								<div class="radio">
									<label>
										<input type="radio" class="image_radios" name="image_radios" value="{{this}}" {{image_radio_is_checked}}>
										{{image_name this}}
									</label>
								</div>
							{{/each}}
						</div>
					</div>
				{{/if}}

			{{/if}}		<!-- is owner -->

			{{#if dupes}}
				<div class="panel panel-default">
					<div class="panel-heading">
						Possible Duplicate Users
					</div>
					<div class="panel-body">
						<ul>
							{{#each dupes}}
								<li>{{this}}</li>
							{{/each}}
						</ul>
					</div>
				</div>
			{{/if}}

		{{else}}
			<div class="pad_group" style="text-align:center;">
				<i class="fa fa-refresh fa-spin"></i>
				&nbsp;
				Loading
			</div>
		{{/if}}


		{{#if battleInfoLoaded}}
			{{#if battle}}
				<div class="panel panel-default">
					<div class="panel-heading">
						Battle
					</div>
					<div class="panel-body">
						{{> battle_report battle}}
					</div>
				</div>
			{{/if}}
		{{/if}}

	</div>
</template>
